# bitrix_docker_monolith
Bitrix в одном монолитном контейнере
# Требования
Операционная система: Ubuntu 18 или новее. На других версиях может работать, но не тестировалось. Должен быть установлен Docker, [согласно инструкции](https://docs.docker.com/engine/install/ubuntu/). В случае запуска команд без чтения инструкций, выполните:
```
curl -s https://get.docker.com | sh
```
Добавьте себя в группу `docker` для выполнения команд без `sudo`:
```
sudo usermod -aG docker $USER && exit
```
Откройте терминал заново. Теперь без ошибок прав доступа должна выпониться команда:
```
docker ps
```
Также должен быть установлен Git:
```
sudo apt update && sudo apt install -y git
```
# Использование
Создайте проект:
```
git clone https://github.com/abicorios/bitrix_docker_monolith projectname
```
Удалите папку `.git` чтобы потом не было сложностей при работе через git с файлами своего сайта:
```
cd projectname
./rm_dot_git.sh
```
Создайте образ и контейнер:
```
./create_bitrix.sh
```
Откройте сайт в браузере по адресу `127.0.0.1`. Для управления контейнером и мониторинга используйте скрипты `./status.sh`, `./stop.sh`, `./start.sh`, `./restart.sh`, `./login.sh`. Если залогиниться в контейнер, то выйти из него можно командой `exit`.
Для удаления контейнера и образа используйте команду:
```
./rm_bitrix.sh
```
# Дополнительная информация
Может быть полезно удалить неисползуемые виртуальные диски:
```
docker volume prune
```
Удаление неиспользуемых дисков не включено в автоматический скрипт `create_bitrix.sh`, потому что у кого-то может хранится важная рабочая информация во временно неиспользуемых дисках.
По умолчанию в качестве имени проекта используется имя директории, оно используется потом как имя образа и контейнера. Чтобы изменить имя проекта, можно отредактировать его в файле `config` перед созданием образа, если же переименование проекта или папки произойдёт после создания образа то скрипты будут работать некорректно. Папка `www` с файлами сайта создаётся автоматически при создании контейнера, в той же папке что и `config`.
